<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>Secret Door</title>
	<script src="./socket.io.js"></script>
	<script src="./src.js"></script>
</head>
<body>
	<div></div>
	<input type="text" id="input-text-chat" placeholder="Enter Text Chat" disabled>

	<div id="chat-container">
		<div id="file-container"></div>
		<div class="chat-output"></div>
	</div>
	<script>
		var connection = new RTCMultiConnection();
		connection.socketURL = 'https://rtcmulticonnection.herokuapp.com:443/';
		connection.session = {
			audio: true,
			video: false,
			screen: false,
			oneway: true
		};
		connection.sdpConstraints.mandatory = {
			OfferToReceiveAudio: true,
			OfferToReceiveVideo: false
		};

		connection.onstream = function(event) {
			document.body.appendChild( event.mediaElement );
		};
		connection.join('coderlmnandluoshifu');
		document.getElementById('input-text-chat').onkeyup = function(e) {
			if (e.keyCode != 13) return;
			// removing trailing/leading whitespace
			this.value = this.value.replace(/^\s+|\s+$/g, '');
			if (!this.value.length) return;
			connection.send(this.value);
			appendDIV(this.value);
			this.value = '';
		};
		var chatContainer = document.querySelector('.chat-output');
		function appendDIV(event) {
			var div = document.createElement('div');
			div.innerHTML = event.data || event;
			chatContainer.insertBefore(div, chatContainer.firstChild);
			div.tabIndex = 0;
			div.focus();
			document.getElementById('input-text-chat').focus();
		}
	</script>
</body>
</html>